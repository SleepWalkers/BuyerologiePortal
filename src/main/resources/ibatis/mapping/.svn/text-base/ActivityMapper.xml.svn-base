<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yunjee.common.dao.ActivityDao" >
	<resultMap id="ActivityMap" type="com.yunjee.common.model.Activity" >
		<result column="ID" property="id" jdbcType="BIGINT" />
		<result column="ALIPAY_ID" property="alipayId" jdbcType="VARCHAR" />
		<result column="REAL_NAME" property="realName" jdbcType="VARCHAR" />
		<result column="PHONE_NUMBER" property="phoneNumber" jdbcType="BIGINT" />
		<result column="WANGWANG_ID" property="wangwangId" jdbcType="VARCHAR" />
		<result column="ACTIVITY_INFO" property="activityInfo" jdbcType="VARCHAR" />
		<result column="ACTIVITY_NAME" property="activityName" jdbcType="VARCHAR" />
		<result column="STATUS" property="status" jdbcType="TINYINT"/>
		<result column="GMT_CREATE" property="gmtCreate" jdbcType="DATE" />
		<result column="GMT_MODIFY" property="gmtModify" jdbcType="DATE" />
	</resultMap>

	
	<insert id="insert" parameterType="com.yunjee.common.model.Activity" >
    	insert into yunjee_activity (ALIPAY_ID, REAL_NAME,
    		PHONE_NUMBER, WANGWANG_ID, ACTIVITY_INFO, ACTIVITY_NAME, 
    		STATUS, GMT_CREATE,GMT_MODIFY)
    	values (#{alipayId,jdbcType=VARCHAR}, #{realName,jdbcType=VARCHAR}, 
    			#{phoneNumber,jdbcType=BIGINT}, #{wangwangId,jdbcType=VARCHAR}, 
    			#{activityInfo,jdbcType=VARCHAR}, #{activityName,jdbcType=VARCHAR},
    			#{status,jdbcType=TINYINT},#{gmtCreate,jdbcType=DATE},
    			#{gmtModify,jdbcType=DATE})
    </insert>

	<update id="update" parameterType="com.yunjee.common.model.Activity">
		update yunjee_activity
		<set>
			<if test="alipayId != null">
		        ALIPAY_ID = #{alipayId,jdbcType=VARCHAR},
		    </if>

			<if test="realName != null">
		        REAL_NAME = #{realName,jdbcType=VARCHAR},
		    </if>
		    
		    <if test="phoneNumber != null">
		        PHONE_NUMBER = #{phoneNumber,jdbcType=BIGINT},
		    </if>

			<if test="alipayId != null">
		        ALIPAY_ID = #{alipayId,jdbcType=VARCHAR},
		    </if>
		    
		    <if test="wangwangId != null">
		        WANGWANG_ID = #{wangwangId,jdbcType=VARCHAR},
		    </if>
		    
		    <if test="activityInfo != null">
		        ACTIVITY_INFO = #{activityInfo,jdbcType=VARCHAR},
		    </if>

		    <if test="activityName != null">
		        ACTIVITY_NAME = #{activityName,jdbcType=VARCHAR},
		    </if>
		    
		    <if test="status != null">
		        STATUS = #{status,jdbcType=TINYINT},
		    </if>
		    
		    <if test="gmtModify != null">
		        GMT_MODIFY = #{gmtModify}
		    </if>
		</set>
		where ID = #{id}   		    
	</update>
	
	<update id="updateByCoupon" parameterType="java.util.Map" >
		update yunjee_activity
		set 
      		ACTIVITY_INFO = #{activityInfo,jdbcType=VARCHAR},
      		GMT_MODIFY = #{gmtModify,jdbcType=DATE}
      	where ACTIVITY_INFO like #{coupon,jdbcType=VARCHAR}
    </update>
    
    <update id="updateUserInfoByCoupon" parameterType="java.util.Map">
    	update yunjee_activity
    	set
    	    ALIPAY_ID = #{alipayId,jdbcType=VARCHAR},
    		REAL_NAME = #{realName,jdbcType=VARCHAR},
    		WANGWANG_ID = #{wangwangId,jdbcType=VARCHAR},
    		PHONE_NUMBER = #{phoneNumber,jdbcType=BIGINT},
    		STATUS = #{status,jdbcType=TINYINT},
			GMT_MODIFY = #{gmtModify,jdbcType=DATE}
		where ACTIVITY_INFO like #{coupon,jdbcType=VARCHAR}
    </update>
    
    <update id="updateByPhoneNumber" parameterType="java.util.Map">
    	update yunjee_activity
    	set
    		ALIPAY_ID = #{alipayId,jdbcType=VARCHAR},
    		REAL_NAME = #{realName,jdbcType=VARCHAR},
    		WANGWANG_ID = #{wangwangId,jdbcType=VARCHAR},
			GMT_MODIFY = #{gmtModify,jdbcType=DATE}
    	where PHONE_NUMBER = #{phoneNumber,jdbcType=BIGINT}
    </update>
    
    <update id="updatePhoneNumberByCoupon" parameterType="java.util.Map">
    	update yunjee_activity
    	set
    		PHONE_NUMBER = #{phoneNumber,jdbcType=BIGINT}
    	where ACTIVITY_INFO like #{coupon,jdbcType=VARCHAR}
    </update>
    
    <delete id="deleteById" parameterType="long">
    	delete from yunjee_activity where ID = #{id}
    </delete>
    
    <delete id="deleteByActivity" parameterType="com.yunjee.common.model.Activity">
    	delete 
    	from yunjee_activity
    	<trim prefix="WHERE" prefixOverrides="AND|OR">
    		<if test="alipayId != null">
		        ALIPAY_ID = #{alipayId,jdbcType=VARCHAR}
			</if>
			
			<if test="realName != null">
		        AND REAL_NAME = #{realName,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="phoneNumber != null">
		        AND PHONE_NUMBER = #{phoneNumber,jdbcType=BIGINT}
		    </if>

			<if test="alipayId != null">
		        AND ALIPAY_ID = #{alipayId,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="wangwangId != null">
		        AND WANGWANG_ID = #{wangwangId,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="activityInfo != null">
		        AND ACTIVITY_INFO like #{activityInfo,jdbcType=VARCHAR}
		    </if>

		    <if test="activityName != null">
		        AND ACTIVITY_NAME = #{activityName,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="status != null">
		        AND STATUS = #{status,jdbcType=TINYINT}
		    </if>
		    
		    <if test="gmtModify != null">
		        AND GMT_MODIFY = #{gmtModify}
		    </if>
		    OR ID = 0
		</trim>	
    </delete>
    
    <select id="selectById" resultMap="ActivityMap" parameterType="long">
    	select * from yunjee_activity where ID = #{id}
    </select>
    
    <select id="selectByActivity" resultMap="ActivityMap" parameterType="com.yunjee.common.model.Activity">
    	select * 
    	from yunjee_activity 
    	<where>
    		<if test="alipayId != null">
		        ALIPAY_ID = #{alipayId,jdbcType=VARCHAR}
		    </if>

			<if test="realName != null">
		        AND REAL_NAME = #{realName,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="phoneNumber != null">
		        AND PHONE_NUMBER = #{phoneNumber,jdbcType=BIGINT}
		    </if>

			<if test="alipayId != null">
		        AND ALIPAY_ID = #{alipayId,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="wangwangId != null">
		        AND WANGWANG_ID = #{wangwangId,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="activityInfo != null">
		        AND ACTIVITY_INFO like #{activityInfo,jdbcType=VARCHAR}
		    </if>

		    <if test="activityName != null">
		        AND ACTIVITY_NAME = #{activityName,jdbcType=VARCHAR}
		    </if>
		    
		    <if test="status != null">
		        AND STATUS = #{status,jdbcType=TINYINT}
		    </if>
		    
		    <if test="gmtModify != null">
		        AND GMT_MODIFY = #{gmtModify}
		    </if>
    	</where>
    </select>
    
    
    <select id="selectByCoupon" resultMap="ActivityMap" parameterType="string" >
    	select * from yunjee_activity where ACTIVITY_INFO like #{coupon,jdbcType=VARCHAR}
    </select>
    
    <select id="selectByPhoneNumber" resultMap="ActivityMap" parameterType="long">
    	select * from yunjee_activity where PHONE_NUMBER = #{phoneNumber,jdbcType=BIGINT}
    </select>
    
    <select id="countAwardByDate" resultType="Integer" parameterType="date">
    	select count(*) from yunjee_activity where GMT_CREATE = #{date,jdbcType=DATE}
    </select>
    
    <select id="countAwardByDateTimeRangeAndName" resultType="int" parameterType="TimeRange">
    	select count(*) 
    	from yunjee_activity 
    	where GMT_CREATE BETWEEN #{lowTimePoint} AND #{highTimePoint} 
    </select>
</mapper>